<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CEO CONTROL PANEL | DIRECT PUBLISH</title>
    <style>
        :root { --b-yellow: #FCD535; --b-dark: #1E2329; --b-bg: #0B0E11; --card: #1E2329; }
        body { background: var(--b-bg); color: #EAECEF; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; }
        
        .admin-container { max-width: 1000px; margin: 0 auto; display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        
        .control-card { background: var(--card); padding: 30px; border-radius: 12px; border: 1px solid #333; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .control-card h2 { color: var(--b-yellow); margin-top: 0; border-bottom: 1px solid #333; padding-bottom: 15px; font-size: 20px; }
        
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 8px; font-size: 13px; color: #848E9C; }
        input { width: 100%; padding: 12px; background: #2B3139; border: 1px solid #444; color: #fff; border-radius: 4px; box-sizing: border-box; outline: none; }
        input:focus { border-color: var(--b-yellow); }
        
        .pub-btn { width: 100%; padding: 15px; background: var(--b-yellow); color: #000; font-weight: bold; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; transition: 0.2s; }
        .pub-btn:hover { background: #e2c02e; }

        /* ডান পাশের লাইভ রেকর্ড লিস্ট */
        .record-card { background: var(--card); padding: 30px; border-radius: 12px; border: 1px solid #333; height: 500px; overflow-y: auto; }
        .record-item { background: #2B3139; padding: 10px; border-radius: 6px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border-left: 4px solid var(--b-yellow); }
        .del-btn { background: #F6465D; color: #fff; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; }
        
        .header-bar { text-align: center; margin-bottom: 40px; }
        .header-bar h1 { color: #fff; font-size: 28px; letter-spacing: 1px; }
        .header-bar span { color: var(--b-yellow); }

        /* স্ক্রলবার কাস্টমাইজ */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #444; border-radius: 10px; }
    </style>
</head>
<body>

    <div class="header-bar">
        <h1><span>CEO</span> MASTER CONTROL PANEL</h1>
        <p>Directly Update Wall & Manage Live Assets</p>
    </div>

    <div class="admin-container">
        
        <div class="control-card">
            <h2>PUBLISH NEW PLOT</h2>
            <div class="input-group">
                <label>Brand / Company Name</label>
                <input type="text" id="mBrand" placeholder="e.g. Binance Elite">
            </div>
            <div class="input-group">
                <label>Logo URL (Direct Image Link)</label>
                <input type="text" id="mImg" placeholder="https://i.ibb.co/example.png">
            </div>
            <div class="input-group">
                <label>Website URL (Backlink)</label>
                <input type="text" id="mWeb" placeholder="https://company.com">
            </div>
            <div class="input-group">
                <label>Assign Plot Number (1 - 5000)</label>
                <input type="number" id="mPlot" placeholder="Enter ID">
            </div>
            <button class="pub-btn" onclick="directPublish()">PUBLISH TO WALL LIVE</button>
            <p style="font-size: 11px; color: #666; margin-top: 15px;">* This action bypasses the customer order queue and goes live instantly.</p>
        </div>

        <div class="record-card">
            <h2 style="color: #fff; font-size: 18px; margin-top: 0;">LIVE WALL RECORDS</h2>
            <div id="liveRecords">
                <p style="color: #666;">Loading live assets...</p>
            </div>
        </div>

    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDgLYZLFCF8yiQ-58Z1wmMC-MczxwyItw0",
            authDomain: "m-legacy-5cf2b.firebaseapp.com",
            databaseURL: "https://m-legacy-5cf2b-default-rtdb.firebaseio.com",
            projectId: "m-legacy-5cf2b"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ১. সরাসরি পাবলিশ ফাংশন
        function directPublish() {
            const name = document.getElementById('mBrand').value;
            const img = document.getElementById('mImg').value;
            const web = document.getElementById('mWeb').value;
            const pid = parseInt(document.getElementById('mPlot').value);

            if (!name || !img || !pid) return alert("All fields are required!");
            if (pid < 1 || pid > 5000) return alert("Plot must be 1-5000");

            const x = ((pid - 1) % 100) * 40;
            const y = Math.floor((pid - 1) / 100) * 25;

            db.ref('pixels/' + pid).set({
                name: name, imageUrl: img, link: web || "#", x: x, y: y, plotID: pid
            }).then(() => {
                db.ref('notifications/' + pid).set({ status: "Approved", message: "Manually Added by CEO" });
                alert("Plot " + pid + " is now LIVE!");
                // ফর্ম ক্লিয়ার করা
                document.getElementById('mBrand').value = "";
                document.getElementById('mImg').value = "";
                document.getElementById('mWeb').value = "";
                document.getElementById('mPlot').value = "";
            });
        }

        // ২. লাইভ রেকর্ড লিস্ট আপডেট (History View)
        db.ref('pixels').on('value', s => {
            const container = document.getElementById('liveRecords');
            container.innerHTML = "";
            const data = s.val();
            if (!data) {
                container.innerHTML = "<p style='color: #666;'>Wall is currently empty.</p>";
                return;
            }
            Object.keys(data).sort((a,b) => a - b).forEach(id => {
                container.innerHTML += `
                    <div class="record-item">
                        <div>
                            <span style="color: var(--b-yellow); font-weight: bold;">#${id}</span> 
                            <span style="margin-left: 10px;">${data[id].name}</span>
                        </div>
                        <button class="del-btn" onclick="removeAsset('${id}')">DELETE</button>
                    </div>
                `;
            });
        });

        // ৩. ডিলিট ফাংশন
        function removeAsset(id) {
            if (confirm("Reset Plot #" + id + "?")) {
                db.ref('pixels/' + id).remove();
                db.ref('notifications/' + id).remove();
            }
        }
    </script>
</body>
</html>
